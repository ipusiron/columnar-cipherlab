# Columnar CipherLab - 縦列転置式暗号ツール

![GitHub Repo stars](https://img.shields.io/github/stars/ipusiron/columnar-cipherlab?style=social)
![GitHub forks](https://img.shields.io/github/forks/ipusiron/columnar-cipherlab?style=social)
![GitHub last commit](https://img.shields.io/github/last-commit/ipusiron/columnar-cipherlab)
![GitHub license](https://img.shields.io/github/license/ipusiron/columnar-cipherlab)
[![GitHub Pages](https://img.shields.io/badge/demo-GitHub%20Pages-blue?logo=github)](https://ipusiron.github.io/columnar-cipherlab/)

**Day043 - 生成AIで作るセキュリティツール100**

**Columnar CipherLab**は、縦列転置式暗号の暗号化・復号ツールです。

縦列転置式暗号（columnar transposition＝コラム式転置＝コラムナー転置）は、広く使われている転置暗号のひとつ。

平文を長方形（マトリクス）の行方向に書き入れ、列（column）を鍵順で並べ替えて縦に読み出すことで、暗号分を作る。

---

## 🌐 デモページ

👉 [https://ipusiron.github.io/columnar-cipherlab/](https://ipusiron.github.io/columnar-cipherlab/)

---

## 📸 スクリーンショット

> ![ダミー](assets/screenshot.png)  
>
> *ダミー*

---

## 本ツールの使い方

### 暗号化
「暗号化」タブで平文を入力。
完全モードをONにすると総マスが長方形になるよう埋字（パディング文字）で埋めます。
鍵タイプ（キーワード or 数列）を選択。
- キーワード：
  - 同一文字は左側を優先。
  - 例："BALLOON"⇒2134567
- 数列
  - 例 3 1 4 2 / 3,1,4,2 / 3142（重複不可）。
「暗号化」押下で暗号文とグリッドを表示。

---

## 縦列転置式暗号の仕組み

「完全」縦列転置式暗号＝完全（complete）＋縦列転置式暗号
⇒きれいにマトリクスになる。長方形になる。

### 暗号化

平文は横に並べて、コラムを並び替えてから縦に読み進めたのが暗号文になる。

鍵タイプはキーワード or 数列

キーワード＝英単語
数列＝重複しない数字。

マトリクスを作る。
マトリクスの列数は、英単語の文字数（あるいは数列に出てくる数）になる。

平文を左から右に入力していき、右端まで来れば2行目に移る。
同様にして平文の全文字を使ってマトリクスを埋める。
マトリクスの空きには、埋字をセットする（これが「完全」の意味）。

ここまでが処理の1段階目。

次に2段階目は、列の入れ替え。

具体的な入れ替え法については、以下のとおり。
(1)鍵タイプが数列の場合
マトリクスの列ヘッダーとして数列のそれぞれの数を割り当てる。この数を昇順ソートすることで、列を入れ替える。
(2)鍵タイプがキーワードの場合
たとえば、キーワードが"locale"なら、数列は462153になる。
登場するアルファベットの中で、辞書順的に登場する文字が若い数になる。
※同一文字の'l'は、先に登場した方が若い数値になる。

数が小さい列から読み出す。これが暗号文になる。

### 復号

①「暗号文の文字数÷キーワード文字数」で行が確定。

②キーワードを記述して数列にする。番号が若いところから、縦に暗号文を読み込んでいく。最終行に到達したら、別の列でも同様に繰り返す。

③そのまま1行目を左から右へ読んでいく、次に2行目…。これが復号結果。

復号は「復号」タブで暗号文＋同じ鍵を指定し実行。
完全モードではパディング自動除去の切替可。

---

## 縦列転置式暗号の種類

### 種類①「埋字で埋めるか」
- 埋字で埋めて完全なマトリクスを使う⇒完全縦列転置式暗号
- 欠けたままの不完全なマトリクスを使う

### 種類②「鍵を使うか」

- 1段階目で終わる⇒鍵を使わない⇒列の並び替えをしない。
  - レールフェンス暗号のうち、「常に斜め上から斜め下に読んでいく方式」は、1段階のみの縦列転置式暗号そのもの
- 2段階まで処理する
  - 書き出しに鍵を利用する⇒鍵式転置⇒列の並び替え用の数列（鍵数字列） or 英単語のキーワードを使って列の並び替え

鍵についての考察

- 書き出しの順序を乱すためには、鍵に使う数列をあらかじめ送受信者でお互い約束しておいて、その若い番号順に書き出していく。
- 鍵に使う数列としては、同じ数字のないもの選んだ方が確実。
- 英単語のキーワードのとき、同一アルファベットがある場合は先頭に近いほうを優先というルールにする
- 数列が鍵の本質的意味を持つため、キーワードの場合まったく同じキーワードを共有する必要性はない。同じ数列になるような、別のキーワードでもよい（その必要があるかは微妙なところ）。

### 種類③ 空白をカットするか否か

空白をそのままマトリクスに入れる
⇒空白セルあり

空白セルありなら、復号時に空白セルがどこにあるかも知らないと復号できない。

### 種類④二重転置

- (a)2回縦列転置を適用する（＝二重縦列型）
- (b)縦列転置かつ横行転置

### 種類⑤ 書き出しに工夫を施す

縦列転置式暗号の派生形になる。

- 列ごとに書き出す。
- 斜めに書き出す。
- らせん状に書き出す。

---

## 縦列転置式暗号の歴史と背景

### ニヒリスト式置換法

1880年頃、帝政ロシアにはツアーリズムを打倒し、自由主義革命をもくろむニヒリストたちと、それを抑圧しようとする帝政警察第一課との間で死闘が繰り広げられていた。
そんなとき、獄中にいたニヒリストの巨頭「人民の意志」派のミハイロフは、自分に好意を持っているらしい看守を利用して、獄外の同士と連絡を取ろうとたくらんだ。
プロパガンダ用の原稿を手紙にしたため、例の看守に渡したのである。
ところが、その巻首は秘密警察の権限を握るメリコフ伯の手先（つまりスパイだったわけだ）であり、ミハイロフの手紙を受け取ると、すぐメリコフ長官の手元に届けられた。
手紙の内容は暗号文で書かれていた。部下に解読させた結果、二重の転置式暗号文であることが判明した。
縦だけでなく横も並び替えるという、二重の転置だった。

縦列転置式暗号の種類でいえば、種類④の(b)の方式
これをニヒリスト式置換法と呼ぶ。

---

## 他の古典暗号との比較

「ステンシル（空欄がある紙）を用いた分置式暗号」や回転グリル暗号は、平文の書き込みに工夫をしていた。一方、鍵式転置は逆に書き出し（すなわち暗号文）の順序を乱すように工夫する。

---

## 📂 ディレクトリー構成

```
```

---

## 仕様（要点）
グリッドは行方向に投入 → 鍵で決まる列順（昇順）に縦読み。

復号：

列数 n=鍵長、文字数 L、行数 r=ceil(L/n)。

不完全時、最終行に文字が入るのは元の列順の左から L mod n 本のみ（高さいずれも r、残りは r-1）。

暗号文を鍵順の各列に高さい分だけ割当 → 行優先で読み出す。

入力整形：スペース削除／大文字化のトグル。

鍵のルール
キーワード：localeCompare('ja') による安定昇順、同文字は左が若番。

数列：1..n の重複無しを推奨（検証と警告表示）。

教材メモ
置換（転置）は拡散を与えるが非線形は与えない。S-box（非線形）とP層（線形置換）という現代暗号の文脈とも対比できる。

### タブ構成
暗号化（実装）…種類①②まで対応するUIにする。

復号（実装）

二重転置（未実装）：縦×縦／縦×横。歴史的にはニヒリスト式併用も。

派生形（未実装）：斜め、らせん、書き出し位置工夫など。

### 今後のロードマップ
二重転置（縦→縦／縦→横）

派生形：斜め・らせんの可視化

英数字以外のロケールごとの並び替えオプション

クリップボード・トースト、操作履歴、URLクエリ共有

---

## 📄 ライセンス

MIT License - 詳細は [LICENSE](LICENSE) をご覧ください。

---

## 🛠 このツールについて

本ツールは、「生成AIで作るセキュリティツール100」プロジェクトの一環として開発されました。  
このプロジェクトでは、AIの支援を活用しながら、セキュリティに関連するさまざまなツールを100日間にわたり制作・公開していく取り組みを行っています。

プロジェクトの詳細や他のツールについては、以下のページをご覧ください。

🔗 [https://akademeia.info/?page_id=42163](https://akademeia.info/?page_id=42163)
